#include "aes.c"
#include <stdlib.h>

int get_keylen() {
	return AES_KEYLEN;
}

struct AES_ctx* create_ctx() {
	return malloc(sizeof(struct AES_ctx));
}

void destroy_ctx(struct AES_ctx* ctx) {
	free (ctx);
}

void print_data(const uint8_t* data, int length) {
	for (int i=0; i < length; ++i) {
		printf("%d ", data[i]);
	}
	printf("\n");
}

/* int main() {
	struct AES_ctx* ctx = malloc(sizeof(struct AES_ctx));

//	const uint8_t key[AES_KEYLEN] = {0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15};
//	const uint8_t iv[AES_BLOCKLEN] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1};
	uint8_t key[16] = { 0x2b, 0x7e, 0x15, 0x16, 0x28, 0xae, 0xd2, 0xa6, 0xab, 0xf7, 0x15, 0x88, 0x09, 0xcf, 0x4f, 0x3c };
	uint8_t iv[16]  = { 0xf0, 0xf1, 0xf2, 0xf3, 0xf4, 0xf5, 0xf6, 0xf7, 0xf8, 0xf9, 0xfa, 0xfb, 0xfc, 0xfd, 0xfe, 0xff };

	AES_init_ctx_iv(ctx, key, iv);

	uint8_t data[16] = {1,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15};
//	uint8_t data[64]  = { 0x87, 0x4d, 0x61, 0x91, 0xb6, 0x20, 0xe3, 0x26, 0x1b, 0xef, 0x68, 0x64, 0x99, 0x0d, 0xb6, 0xce,
//                        0x98, 0x06, 0xf6, 0x6b, 0x79, 0x70, 0xfd, 0xff, 0x86, 0x17, 0x18, 0x7b, 0xb9, 0xff, 0xfd, 0xff,
//                        0x5a, 0xe4, 0xdf, 0x3e, 0xdb, 0xd5, 0xd3, 0x5e, 0x5b, 0x4f, 0x09, 0x02, 0x0d, 0xb0, 0x3e, 0xab,
//                        0x1e, 0x03, 0x1d, 0xda, 0x2f, 0xbe, 0x03, 0xd1, 0x79, 0x21, 0x70, 0xa0, 0xf3, 0x00, 0x9c, 0xee };
	printf("Data before: ");
	print_data(data, 16);

	AES_CTR_xcrypt_buffer(ctx, data, 16);
	printf("Encrypted data: ");
	print_data(data, 16);

	AES_ctx_set_iv(ctx, iv);
	AES_CTR_xcrypt_buffer(ctx, data, 16);
	printf("Decrypted data: ");
	print_data(data, 16);


	return 0;
} */
